---
title: "Group 7 Final project"
subtitle: "Cell-type and brain region-resolved mouse proteome"
format:
  revealjs:
    fig-format: png
    execute:
      fig-device: ragg_png
editor: visual
---

# Libraries

```{r}
#| warning: false
library("tidyverse")
library("pcaMethods")
library("janitor")
library("patchwork")
library("ggrepel")

#Source functions
source("../R/99_proj_func.R")
```

# Introduction

Marianna

# Materials & Methods

## Overall workflow (including data cleaning)

Renata

Louise

Maria

# Results

## Louise

sampletext

## Marianna

sampletext

## Renata

sampletext

## Maria

sampletext

## Principal Component Analysis

```{r}
#| warning: false

clean_regions <- read_tsv(file = "../data/clean_data/clean_17.tsv") 
clean_regions <- clean_regions |> 
    select(14:23) 

colnames(clean_regions) <- (c("Brainstem", "Cerebellum", "Corpus callosum", "Motor cortex", 
  "Olfactory bulb", "Optic nerve", "Prefrontal cortex", "Striatum", "Thalamus", 
  "Hippocampus"))

#############################################################################

#Create an object with ONLY numerical data for the PCA object
numerical_brain_regions <- clean_regions |> 
  select_if(map_lgl(.x = clean_regions, .f = is.numeric)) |> 
  remove_empty("rows") #Comepletely empty rows can't be used at all (this is said by checkData, used in the following steps)

#############################################################################

brdata <- numerical_brain_regions |> 
  prep(scale = "none", center = T) 

resPCA <- pca(brdata, method = "svd", center = F, nPcs = 5)

#############################################################################

#Get the PCA values
pcaData <- as.data.frame(loadings(resPCA)) |> 
  mutate(region = row.names(loadings(resPCA)))

#Get the % of variability captured by each PC
PC1var <- resPCA@R2[1] * 100
PC2var <- resPCA@R2[2] * 100

#Plot!
PCA_plot <- pcaData |> 
  ggplot(aes(x = PC1, y = PC2)) +
  geom_point(color = "blue", shape = 19) +
  geom_label_repel(aes(label = region),
                   size = 3) +
  labs(y = paste("Principal component 2 (", PC2var, "% variability )"),
       x = paste("Principal component 1 (", PC1var, "% variability )"),
       title = "PCA of proteome by brain region") +
  theme_minimal()

```

```{r}
PCA_plot
```

# Conclusion

-   Together, our figures tell one story: the mouse brain is built from a shared core proteome that is tuned in each cell type and region to perform very specific tasks

-   The transcriptomeâ€“proteome comparisons show that mRNA alone cannot capture this tuning, while the PCA across regions reveals that even at a global scale, protein expression maps neatly onto brain anatomy

-   Our marker and enrichment plots then zoom in to show how relatively few but strongly enriched proteins at the cell surface and synapse give astrocytes, neurons, microglia and oligodendrocytes their distinct molecular fingerprints and interactions
